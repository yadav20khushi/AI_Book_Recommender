{% comment %} Sidebar Section - Chat History {% endcomment %}
<div class="sidebar">
    <h3>ğŸ“š ëŒ€í™” íˆìŠ¤í† ë¦¬</h3>
    <p>ì´ {{ chat_history|length }}ê°œ</p>
    <ul class="chat-history-list">
        {% for chat in chat_history %}
        <li class="chat-history-item">
            <form method="post" action="{% url 'load_chat' %}">
                {% csrf_token %}
                <input type="hidden" name="chat_id" value="{{ chat.id }}">
                <button type="submit" class="chat-history-btn">
                    {{ chat.user_history.book.title|default:"(ì œëª© ì—†ìŒ)"|truncatechars:25 }}
                </button>
            </form>
        </li>
        {% empty %}
        <li><em>íˆìŠ¤í† ë¦¬ê°€ ì—†ìŠµë‹ˆë‹¤</em></li>
        {% endfor %}
    </ul>

    <form method="post" action="{% url 'signout' %}" class="logout-form">
        {% csrf_token %}
        <button type="submit" class="logout-btn">ë¡œê·¸ì•„ì›ƒ</button>
    </form>
</div>

{% comment %} Main Content Area: Book List {% endcomment %}
<div class="main-content">
    <div class="content-header">
        <h2>{{ username }}ë‹˜ì˜ ì¶”ì²œ ë„ì„œ ëª©ë¡</h2>
        <p>ì±…ì„ í´ë¦­í•˜ë©´ ëŒ€í™”ë¥¼ ì‹œì‘í•©ë‹ˆë‹¤.</p>
    </div>

    {% if books %}
    <div class="books-grid">
        {% for book in books %}
        <div class="book-card">
            <form method="post" action="{% url 'selected_book' %}">
                {% csrf_token %}
                <input type="hidden" name="isbn13" value="{{ book.isbn13 }}">
                <button type="submit">
                    <img src="{{ book.cover }}" alt="í‘œì§€" class="book-cover">
                    <div class="book-title">{{ book.title }}</div>
                    <div class="book-author">{{ book.author }}</div>
                </button>
            </form>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <p>ì¶”ì²œëœ ì±…ì´ ì—†ìŠµë‹ˆë‹¤. ì²« ëŒ€í™”ë¥¼ ì‹œì‘í•´ë³´ì„¸ìš”!</p>
    {% endif %}
</div>
